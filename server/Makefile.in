
CLEANFILES = gen_test_char gen_uri_delims test_char.h uri_delims.h

LTLIBRARY_NAME    = libmain.la
LTLIBRARY_SOURCES = \
    uri_delims.h test_char.h \
	buff.c http_config.c http_core.c http_log.c http_main.c \
	http_protocol.c http_request.c http_vhost.c util.c util_date.c \
	util_script.c util_uri.c util_md5.c util_cfgtree.c util_ebcdic.c \
	rfc1413.c http_connection.c listen.c \
        mpm_common.c util_charset.c util_debug.c util_xml.c \
	util_filter.c

include $(top_srcdir)/build/ltlib.mk

gen_uri_delims_OBJECTS = gen_uri_delims.lo
gen_uri_delims: $(gen_uri_delims_OBJECTS)
	$(LINK) $(EXTRA_LDFLAGS) $(gen_uri_delims_OBJECTS) $(EXTRA_LIBS)

gen_test_char_OBJECTS = gen_test_char.lo util_debug.lo
gen_test_char: $(gen_test_char_OBJECTS)
	$(LINK) $(EXTRA_LDFLAGS) $(gen_test_char_OBJECTS) $(EXTRA_LIBS)

$(gen_uri_delims_OBJECTS) $(gen_test_char_OBJECTS): %.lo: %.c
	$(BUILD_LT_COMPILE)
	$(LT_COMPILE)

uri_delims.h: gen_uri_delims
	./build-gen_uri_delims > uri_delims.h

test_char.h: gen_test_char
	./build-gen_test_char > test_char.h

util_uri.lo: uri_delims.h
util.lo: test_char.h
