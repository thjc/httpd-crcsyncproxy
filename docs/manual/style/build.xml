<project name="manual" default="xslt" basedir=".">

    <!-- Initialization properties -->
    <path id="classpath">
        <fileset dir="./lib">
            <include name="**/*.jar"/>
        </fileset>
    </path>


<!-- This target is for output of HTML pages via XSLT -->
  <!-- Requires JAXP/1.1 (all three JARs) or Xerces+Xalan -->
  <target name="xslt"
   description="Render HTML Pages via XSLT">

    <!-- Additional dependencies -->
    <dependset>
      <targetfilelist dir="../mod/"
                      files="directives.html.en"/>
      <srcfileset dir="../mod/"
                  includes="*.xml"
                  excludes="allmodules.xml index.xml"/>
    </dependset>

    <dependset>
      <targetfilelist dir="../mod/"
                      files="index.html.en"/>
      <srcfilelist dir="../mod/"
                   files="allmodules.xml"/>
    </dependset>

    <!-- Transform the modules directory -->
    <style   basedir="../mod/"
             destdir="../mod/"
           extension=".html"
               style="./manual.en.xsl"
            includes="*.xml"
            excludes="allmodules.xml">
      <mapper type="glob" from="*.xml" to="*.html.en"/>
      <param name="relative-path" expression="."/>
    </style>
    <style   basedir="../mod/"
             destdir="../mod/"
           extension=".html"
               style="./manual.ja.xsl"
            includes="*.xml.ja"
            excludes="allmodules.xml.ja">
      <mapper type="glob" from="*.xml.ja" to="*.html.ja.jis"/>
      <param name="relative-path" expression="."/>
    </style>

   <!-- Transform the root directory of the manual -->
    <style   basedir="../"
             destdir="../"
           extension=".html"
               style="./manual.en.xsl"
            includes="*.xml">
      <mapper type="glob" from="*.xml" to="*.html.en"/>
      <param name="relative-path" expression="."/>
    </style>
    <style   basedir="../"
             destdir="../"
           extension=".html"
               style="./manual.ja.xsl"
            includes="*.xml.ja">
      <mapper type="glob" from="*.xml.ja" to="*.html.ja.jis"/>
      <param name="relative-path" expression="."/>
    </style>

  </target>
  <target name="validate"
      description="Validate the XML source files">
      <!-- Validate almost all XML files in all languages -->
      <xmlvalidate lenient="false" failonerror="false" warn="true">
          <fileset dir="../"
                   includes="**/*.xml **/*.xml.*"
                   excludes="mod/allmodules.xml mod/allmodules.xml.* style/**"/>
      </xmlvalidate>
  </target>
</project>
