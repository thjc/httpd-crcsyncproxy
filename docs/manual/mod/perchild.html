<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="generator" content="HTML Tidy, see www.w3.org" />

    <title>Apache MPM perchild</title>
  </head>
  <!-- Background white, links blue (unvisited), navy (visited), red (active) -->

  <body bgcolor="#FFFFFF" text="#000000" link="#0000FF"
  vlink="#000080" alink="#FF0000">
    <!--#include virtual="header.html" -->

    <h1 align="CENTER">Multi-Processing Module perchild</h1>

<blockquote><strong>
This MPM does not current work.  Work is ongoing to make in functional.
</strong></blockquote>

    <p>This Multi-Processing Module allows for daemon processes
    serving requests to be assigned a variety of different
    userids.</p>

    <p><a href="module-dict.html#Status"
    rel="Help"><strong>Status:</strong></a> MPM<br />
     <a href="module-dict.html#SourceFile"
    rel="Help"><strong>Source File:</strong></a> perchild.c<br />
     <a href="module-dict.html#ModuleIdentifier"
    rel="Help"><strong>Module Identifier:</strong></a>
    mpm_perchild_module</p>

    <h2>Summary</h2>

    <p>This Multi-Processing Module (MPM) implements a hybrid
    multi-process, multi-threaded web server. A fixed number of
    processes create threads to handle requests. Fluctuations in
    load are handled by increasing or decreasing the number of
    threads in each process.</p>

    <p>A single control process launches the number of child
    processes indicated by the <code>NumServers</code> directive at
    server startup. Each child process creates threads as specified
    in the <code>StartThreads</code> directive. The individual
    threads then listen for connections and serve them when they
    arrive.</p>

    <p>Apache always tries to maintain a pool of <em>spare</em> or
    idle server threads, which stand ready to serve incoming
    requests. In this way, clients do not need to wait for new
    threads to be created. For each child process, Apache assesses
    the number of idle threads and creates or destroys threads to
    keep this number within the boundaries specified by
    <code>MinSpareThreads</code> and <code>MaxSpareThreads</code>.
    Since this process is very self-regulating, it is rarely
    necessary to modify these directives from their default values.
    The maximum number of clients that may be served simultaneously
    is determined by multiplying the number of server processes
    that will be created (<code>NumServers</code>) by the maximum
    number of threads created in each process
    (<code>MaxThreadsPerChild</code>).</p>

    <p>While the parent process is usually started as root under
    Unix in order to bind to port 80, the child processes and
    threads are launched by Apache as a less-privileged user. The
    <code>User</code> and <code>Group</code> directives are used to
    set the privileges of the Apache child processes. The child
    processes must be able to read all the content that will be
    served, but should have as few privileges beyond that as
    possible. In addition, unless <a
    href="../suexec.html">suexec</a> is used, these directives also
    set the privileges which will be inherited by CGI scripts.</p>

    <p><code>MaxRequestsPerChild</code> controls how frequently the
    server recycles processes by killing old ones and launching new
    ones.</p>

    <p>See also: <a href="../bind.html">Setting which addresses and
    ports Apache uses</a>.</p>

    <p>In addition it adds the extra ability to specify that
    specific processes should serve requests under different
    userids. These processes can then be associated with specific
    virtual hosts.</p>
    <!-- XXX: This desperately needs more explanation. -->

    <h2>Directives</h2>

    <ul>
      <li><a href="#assignuserid">AssignUserID</a></li>

      <li><a href="#childperuserid">ChildPerUserID</a></li>

      <li><a
      href="mpm_common.html#coredumpdirectory">CoreDumpDirectory</a></li>

      <li><a href="mpm_common.html#group">Group</a></li>

      <li><a href="mpm_common.html#pidfile">PidFile</a></li>

      <li><a href="mpm_common.html#listen">Listen</a></li>

      <li><a
      href="mpm_common.html#listenbacklog">ListenBacklog</a></li>

      <li><a href="mpm_common.html#lockfile">LockFile</a></li>

      <li><a
      href="mpm_common.html#maxrequestsperchild">MaxRequestsPerChild</a></li>

      <li><a
      href="mpm_common.html#maxsparethreads">MaxSpareThreads</a></li>

      <li><a
      href="mpm_common.html#maxthreadsperchild">MaxThreadsPerChild</a></li>

      <li><a
      href="mpm_common.html#minsparethreads">MinSpareThreads</a></li>

      <li><a href="mpm_common.html#numservers">NumServers</a></li>

      <li><a
      href="mpm_common.html#scoreboardfile">ScoreBoardFile</a></li>

      <li><a
      href="mpm_common.html#sendbuffersize">SendBufferSize</a></li>

      <li><a
      href="mpm_common.html#startthreads">StartThreads</a></li>

      <li><a href="mpm_common.html#user">User</a></li>
    </ul>
    <hr />

    <h2><a id="assignuserid" name="assignuserid">AssignUserID
    directive</a></h2>

    <p><a href="directive-dict.html#Syntax"
    rel="Help"><strong>Syntax:</strong></a>AssignUserID <em>user_id</em> <em>group_id</em><br />
     <a href="directive-dict.html#Default"
    rel="Help"><strong>Default:</strong></a><br />
     <a href="directive-dict.html#Context"
    rel="Help"><strong>Context:</strong></a> virtual host<br />
     <a href="directive-dict.html#Status"
    rel="Help"><strong>Status:</strong></a> MPM<br />
     <a href="directive-dict.html#Module"
    rel="Help"><strong>Module:</strong></a> perchild</p>

    <p>Tie a virtual host to a specific child process. Requests addressed to
the virtual host where this directive appears will be served by the process
running with the specified user and group id.</p>
    <hr />

    <h2><a id="childperuserid" name="childperuserid">ChildPerUserID
    directive</a></h2>

    <p><a href="directive-dict.html#Syntax"
    rel="Help"><strong>Syntax:</strong></a>ChildPerUserID <em>user_id</em>
<em>group_id</em> <em>child_id</em><br />
     <a href="directive-dict.html#Default"
    rel="Help"><strong>Default:</strong></a><br />
     <a href="directive-dict.html#Context"
    rel="Help"><strong>Context:</strong></a> server config<br />
     <a href="directive-dict.html#Status"
    rel="Help"><strong>Status:</strong></a> MPM<br />
     <a href="directive-dict.html#Module"
    rel="Help"><strong>Module:</strong></a> perchild</p>

    <p>Specify a user id and group id for a specific child process. The number of
children if set by the <a href="mpm_common.html#numservers">NumServers</a>
directive. For example, the default value for <a
href="mpm_common.html#numservers">NumServers</a> is 5 and that means
children ids 1,2,3,4 and 5 are available for assigment. If a child does not
have an associated ChildPerUserID, it inherits the <a
href="mpm_common.html#user">User</a> and <a
href="mpm_common.html#group">Group</a> settings from the main server </p> 
    <!--#include virtual="footer.html" -->
  </body>
</html>

